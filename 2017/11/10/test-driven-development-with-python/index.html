<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Test Driven Development with Python | Just Do It!!!</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Testing a Simple Home Page with Unit TestsUnit Tests, and How They Differ from Functional TestsThe basic distinction, though, is that functional tests test the application from the outside, from the p">
<meta name="keywords" content="python,TDD">
<meta property="og:type" content="article">
<meta property="og:title" content="Test Driven Development with Python">
<meta property="og:url" content="https://ultrasound.github.io/2017/11/10/test-driven-development-with-python/index.html">
<meta property="og:site_name" content="Just Do It!!!">
<meta property="og:description" content="Testing a Simple Home Page with Unit TestsUnit Tests, and How They Differ from Functional TestsThe basic distinction, though, is that functional tests test the application from the outside, from the p">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://ultrasound.github.io/2017/11/10/assets/images/TDD_process.jpg">
<meta property="og:image" content="https://ultrasound.github.io/2017/11/10/assets/images/TDD_process_with_functional_and_unit_tests.jpg">
<meta property="og:updated_time" content="2017-11-10T12:30:53.950Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Test Driven Development with Python">
<meta name="twitter:description" content="Testing a Simple Home Page with Unit TestsUnit Tests, and How They Differ from Functional TestsThe basic distinction, though, is that functional tests test the application from the outside, from the p">
<meta name="twitter:image" content="https://ultrasound.github.io/2017/11/10/assets/images/TDD_process.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Just Do It!!!" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="../../../../css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../../../index.html" id="logo">Just Do It!!!</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="../../../../index.html" id="subtitle">Eat and Play</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="../../../../index.html">Home</a>
        
          <a class="main-nav-link" href="../../../../archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://ultrasound.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-test-driven-development-with-python" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="" class="article-date">
  <time datetime="2017-11-10T11:44:09.000Z" itemprop="datePublished">2017-11-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="../../../../categories/software-development-process/">Software Development Process</a>►<a class="article-category-link" href="../../../../categories/software-development-process/test-driven-development/">Test-Driven Development</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Test Driven Development with Python
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Testing-a-Simple-Home-Page-with-Unit-Tests"><a href="#Testing-a-Simple-Home-Page-with-Unit-Tests" class="headerlink" title="Testing a Simple Home Page with Unit Tests"></a>Testing a Simple Home Page with Unit Tests</h1><h2 id="Unit-Tests-and-How-They-Differ-from-Functional-Tests"><a href="#Unit-Tests-and-How-They-Differ-from-Functional-Tests" class="headerlink" title="Unit Tests, and How They Differ from Functional Tests"></a>Unit Tests, and How They Differ from Functional Tests</h2><p>The basic distinction, though, is that functional tests test the application from the outside, from the pont of view of the user.<br>Unit tests test the application from the inside, from the point of view of the programmer.</p>
<h3>workflow</h3><br>1. We start by writing a <em>functional test</em>, describing the new functionality from the user’s point of view.<br>2. Once we have a functional test that fails, we start to think about how to write code that can get it to pass(or at least to get past its current failure). We now use one or more <em>unit</em> tests to define how we want our code to behave - the idea is that each line of production code we write should be tested by (at least) one of our unit tests.<br>3. Once we have a failing unit test, we write the smallest amount of <em>application code</em> we can, just enough to get the unit test to pass. We may iterate between steps 2 and 3 a few times, until we think the functional test wil get a little further.<br>4. Now we can rerun our functional tests and see if they pass, or get a littel further. That may prompt us to wirte some new unit tests, and some noe code, and so on.<br><br>You can see that, all the way through, the functional test are driving what Development we do from a high level, while the unit tests drive what we do at a low level.<br><br>&gt; <h4>Note</h4><br>&gt; functional tests should help you build an application with the right functionality, and guarantee you never accidentally break it. Unit tests should help you to write code that’s clean and bug free.<br><br>—<br><br><h3>Django’s workflow</h3><br>1. An HTTP <em>request</em> comes in for a particular <em>URL</em>.<br>2. Django uses some rules to decide which <em>view</em> function should deal with the request (this is refereed to as <em>resolving</em> the URL).<br>3. The view function processes the request and returns an HTTP <em>response</em>.<br><br>So we want to test two things:<br>- Can we resolve the URL for the root of the site (“/“) to a particular view function we’ve made?<br>- Can we make this view function return some HTML which will get the functional test to pass?<br><br>—<br><br><h3>READING TRACEBACKS</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">======================================================================</span><br><span class="line">ERROR: test_root_url_resolves_to_home_page_view (lists.tests.HomePageTest)  2</span><br><span class="line"> ---------------------------------------------------------------------</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/.../superlists/lists/tests.py&quot;, line 8, in</span><br><span class="line">test_root_url_resolves_to_home_page_view</span><br><span class="line">    found = resolve(&apos;/&apos;)  3</span><br><span class="line">  File &quot;.../django/urls/base.py&quot;, line 27, in resolve</span><br><span class="line">    return get_resolver(urlconf).resolve(path)</span><br><span class="line">  File &quot;.../django/urls/resolvers.py&quot;, line 392, in resolve</span><br><span class="line">    raise Resolver404(&#123;&apos;tried&apos;: tried, &apos;path&apos;: new_path&#125;)</span><br><span class="line">django.urls.exceptions.Resolver404: &#123;&apos;tried&apos;: [[&lt;RegexURLResolver  1</span><br><span class="line">&lt;RegexURLPattern list&gt; (admin:admin) ^admin/&gt;]], &apos;path&apos;: &apos;&apos;&#125;  1</span><br><span class="line"> ---------------------------------------------------------------------</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure>
<ol>
<li>The first place you look is usually <em>the error itself</em>. Sometimes that’s all you need to see, and it will let you identify the problem immediately. But sometimes, like in this case, it’s not quite self-evident.</li>
<li>The next thing to double-check is: <em>which test is failing?</em> Is it definitely the one we expected - that is, the one we just wrote? In this case, the answer is yes.</li>
<li>Then we look for the place in <em>our test code</em> that kicked off the failure. We work our way down form the top of the traceback, looking for the filename of the tests file, to check which test function, and what line of code, the failure is coming from. In thins case it’s the line where we call the <code>resolve</code> function for the “/“ URL.</li>
</ol>
<p>Pulling it all together, we interpret the traceback as telling us that, when trying to resolve “/“, Django raised a 404 error - in other words, Django can’t find a URL mapping for “/“.</p>
<hr>
<h3>The Unit-Test/Code Cycle</h3>

<p>We can start to settle into the TDD <em>unit-test/code cycle</em> now:</p>
<ol>
<li>Run the unit tests in the terminal, run the unit tests and see how they fail.</li>
<li>Mke a minimal code change in the editor, make a minimal code change to address the current test failure.</li>
<li>Repeat!!!</li>
</ol>
<h1 id="What-Are-We-Doing-wiht-All-These-Tests-And-Refactoring"><a href="#What-Are-We-Doing-wiht-All-These-Tests-And-Refactoring" class="headerlink" title="What Are We Doing wiht All These Tests?(And, Refactoring)"></a>What Are We Doing wiht All These Tests?(And, Refactoring)</h1><h3>Using Selenium to Test User Interactions</h3>

<blockquote>
<p></p><h4>NOTE</h4><br>One of the greate things about TDD is that you never have to worry about forgetting what to do next - just rerun your tests and they will tell you what you need to work on.<p></p>
</blockquote>
<hr>
<h3>The “Don’t Test Constants” Rule, and Templates to the Rescue</h3>

<p>In general, one of the rules of unit testing is <em>Don’t test constants</em>, and testing HTML as text is a lot like testing a constant.</p>
<p>In other words, if you have some code that says:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wibble = <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>There’s not much point in a test that says:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> myprogram <span class="keyword">import</span> wibble</span><br><span class="line"><span class="keyword">assert</span> wibble == <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>Unit tests are really about testing logic, flow control, and configuration. Making assertions about exactly what sequence of characters we have in our HTML strings isn’t doing that.</p>
<p>What’s more, mangling raw strings in Python really isn’t a great way of dealing with HTML. There’s a much better solution, which is to use templates. Quite apart from anythin else, if we can keep HTML to one side in a file whose name ends in <em>.html,</em> we’ll get better syntax highlighting! There are lots of Python templating frameworks out there and Django has its own which works very well.</p>
<h4>Refactoring to Use a Template</h4>

<p>The first rule is that you can’t refactor without tests.</p>
<hr>
<h3> On Refactoring</h3>

<blockquote>
<p></p><h4>TIP</h4><br>When refactoring, work on either the code or the tests, but not both at once.<p></p>
</blockquote>
<hr>
<h3>Recap: The TDD Process</h3>

<ul>
<li>Functional Tests</li>
<li>Unit Tests</li>
<li>The unit-test/code Cycle</li>
<li>Refactoring</li>
</ul>
<p>We write a test. We run the test and see it fail. We write some minimal code to get it a little further. We rerun the test and repeat until it passes. Then, optionally, we might refactor our code, using tests to make sure we don’t break anything.</p>
<p><img src="../assets/images/TDD_process.jpg" alt="TDD process"></p>
<p>But how does this apply when we have functional tests <em>and</em> unit tests? Well, you can think of the functional test as being a high-level view of the cycle, where “writing the code” to get the functional tests to pass actually involves using another, smaller TDD cycle which uses unit tests.</p>
<p><img src="../assets/images/TDD_process_with_functional_and_unit_tests.jpg" alt="TDD process with functional and unit tests"></p>
<p>What about refactoring, in the context of functional tests? Well, that means we use the functional test to check that we’ve preserved the behaviour of our application, but we can change or add and remove unit tests, and use a unit test cycle to acturally change the implementation.</p>
<p>The functional tests are the ultimate judge of whether your application works or not. The unit tests are a tool to help you along the way.</p>
<p>This way of looking at things is sometimes called “Double-Loop TDD”. one of my eminent tech reviewers, Emily Bache, wrote <a href="http://coding-is-like-cooking.info/2013/04/outside-in-development-with-double-loop-tdd/" target="_blank" rel="external">a blog post</a> on the topic, which I recommend for a different perspective.</p>
<h1 id="Saving-User-Input-Testing-the-Database"><a href="#Saving-User-Input-Testing-the-Database" class="headerlink" title="Saving User Input: Testing the Database"></a>Saving User Input: Testing the Database</h1><p>When a functional test fails with an unexpected failure, there ara several things we can do to debug it:</p>
<ul>
<li>Add print statements, to show, for example, what the current page text is.</li>
<li>Improve the <em>error message</em> to show more info about the current state.</li>
<li>Manually visit the site yourself.</li>
<li>Use time.sleep to pause the test during execution.</li>
</ul>
<h1 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h1><p><a href="http://www.obeythetestinggoat.com/" target="_blank" rel="external">Obey the Testing Goat!</a></p>
<p><a href="https://github.com/hjwp/book-example/" target="_blank" rel="external">repo</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://ultrasound.github.io2017/11/10/test-driven-development-with-python/" data-id="cj9tu53qr0001oov31ip2n4y0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/tdd/">TDD</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../../../tags/python/">python</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="../hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/software-development-process/">Software Development Process</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="../../../../categories/software-development-process/test-driven-development/">Test-Driven Development</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/tdd/">TDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../../../tags/python/">python</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="../../../../tags/tdd/" style="font-size: 10px;">TDD</a> <a href="../../../../tags/python/" style="font-size: 10px;">python</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../../../archives/2017/11/">November 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="">Test Driven Development with Python</a>
          </li>
        
          <li>
            <a href="../hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Hyogeun Kim<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="../../../../fancybox/jquery.fancybox.css">
  <script src="../../../../fancybox/jquery.fancybox.pack.js"></script>


<script src="../../../../js/script.js"></script>

  </div>
</body>
</html>